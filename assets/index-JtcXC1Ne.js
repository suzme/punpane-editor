var fl=Object.defineProperty;var al=(e,t,n)=>t in e?fl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var _n=(e,t,n)=>(al(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const f of o)if(f.type==="childList")for(const c of f.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const f={};return o.integrity&&(f.integrity=o.integrity),o.referrerPolicy&&(f.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?f.credentials="include":o.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function l(o){if(o.ep)return;o.ep=!0;const f=n(o);fetch(o.href,f)}})();function He(){}const yn=e=>e;function Wn(e){return e()}function Mn(){return Object.create(null)}function at(e){e.forEach(Wn)}function fn(e){return typeof e=="function"}function cl(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function _l(e){return Object.keys(e).length===0}function En(e){return e??""}const Qn=typeof window<"u";let $n=Qn?()=>window.performance.now():()=>Date.now(),wn=Qn?e=>requestAnimationFrame(e):He;const At=new Set;function xn(e){At.forEach(t=>{t.c(e)||(At.delete(t),t.f())}),At.size!==0&&wn(xn)}function el(e){let t;return At.size===0&&wn(xn),{promise:new Promise(n=>{At.add(t={c:e,f:n})}),abort(){At.delete(t)}}}function u(e,t){e.appendChild(t)}function tl(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function pl(e){const t=p("style");return t.textContent="/* empty */",dl(tl(e),t),t.sheet}function dl(e,t){return u(e.head||e,t),t.sheet}function Me(e,t,n){e.insertBefore(t,n||null)}function ge(e){e.parentNode&&e.parentNode.removeChild(e)}function nt(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function p(e){return document.createElement(e)}function R(e){return document.createTextNode(e)}function C(){return R(" ")}function nl(){return R("")}function w(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function i(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function nn(e){return e===""?null:+e}function hl(e){return Array.from(e.childNodes)}function et(e,t){t=""+t,e.data!==t&&(e.data=t)}function tt(e,t){e.value=t??""}function m(e,t,n,l){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,l?"important":"")}function xt(e,t,n){for(let l=0;l<e.options.length;l+=1){const o=e.options[l];if(o.__value===t){o.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Sn(e){const t=e.querySelector(":checked");return t&&t.__value}function Z(e,t,n){e.classList.toggle(t,!!n)}function gl(e,t,{bubbles:n=!1,cancelable:l=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:l})}const on=new Map;let sn=0;function ml(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function vl(e,t){const n={stylesheet:pl(t),rules:{}};return on.set(e,n),n}function ll(e,t,n,l,o,f,c,d=0){const k=16.666/l;let y=`{
`;for(let g=0;g<=1;g+=k){const N=t+(n-t)*f(g);y+=g*100+`%{${c(N,1-N)}}
`}const S=y+`100% {${c(n,1-n)}}
}`,K=`__svelte_${ml(S)}_${d}`,I=tl(e),{stylesheet:A,rules:M}=on.get(I)||vl(I,e);M[K]||(M[K]=!0,A.insertRule(`@keyframes ${K} ${S}`,A.cssRules.length));const E=e.style.animation||"";return e.style.animation=`${E?`${E}, `:""}${K} ${l}ms linear ${o}ms 1 both`,sn+=1,K}function hn(e,t){const n=(e.style.animation||"").split(", "),l=n.filter(t?f=>f.indexOf(t)<0:f=>f.indexOf("__svelte")===-1),o=n.length-l.length;o&&(e.style.animation=l.join(", "),sn-=o,sn||yl())}function yl(){wn(()=>{sn||(on.forEach(e=>{const{ownerNode:t}=e.stylesheet;t&&ge(t)}),on.clear())})}let bn;function qt(e){bn=e}const St=[],An=[];let Ot=[];const On=[],wl=Promise.resolve();let gn=!1;function bl(){gn||(gn=!0,wl.then(ol))}function Ye(e){Ot.push(e)}const pn=new Set;let Et=0;function ol(){if(Et!==0)return;const e=bn;do{try{for(;Et<St.length;){const t=St[Et];Et++,qt(t),kl(t.$$)}}catch(t){throw St.length=0,Et=0,t}for(qt(null),St.length=0,Et=0;An.length;)An.pop()();for(let t=0;t<Ot.length;t+=1){const n=Ot[t];pn.has(n)||(pn.add(n),n())}Ot.length=0}while(St.length);for(;On.length;)On.pop()();gn=!1,pn.clear(),qt(e)}function kl(e){if(e.fragment!==null){e.update(),at(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ye)}}function Kl(e){const t=[],n=[];Ot.forEach(l=>e.indexOf(l)===-1?t.push(l):n.push(l)),n.forEach(l=>l()),Ot=t}let Jt;function il(){return Jt||(Jt=Promise.resolve(),Jt.then(()=>{Jt=null})),Jt}function rn(e,t,n){e.dispatchEvent(gl(`${t?"intro":"outro"}${n}`))}const ln=new Set;let lt;function Dl(){lt={r:0,c:[],p:lt}}function Nl(){lt.r||at(lt.c),lt=lt.p}function mn(e,t){e&&e.i&&(ln.delete(e),e.i(t))}function Pn(e,t,n,l){if(e&&e.o){if(ln.has(e))return;ln.add(e),lt.c.push(()=>{ln.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}else l&&l()}const sl={duration:0};function rl(e,t,n){const l={direction:"in"};let o=t(e,n,l),f=!1,c,d,k=0;function y(){c&&hn(e,c)}function S(){const{delay:I=0,duration:A=300,easing:M=yn,tick:E=He,css:g}=o||sl;g&&(c=ll(e,0,1,A,I,M,g,k++)),E(0,1);const N=$n()+I,W=N+A;d&&d.abort(),f=!0,Ye(()=>rn(e,!0,"start")),d=el(Re=>{if(f){if(Re>=W)return E(1,0),rn(e,!0,"end"),y(),f=!1;if(Re>=N){const Ee=M((Re-N)/A);E(Ee,1-Ee)}}return f})}let K=!1;return{start(){K||(K=!0,hn(e),fn(o)?(o=o(l),il().then(S)):S())},invalidate(){K=!1},end(){f&&(y(),f=!1)}}}function ul(e,t,n){const l={direction:"out"};let o=t(e,n,l),f=!0,c;const d=lt;d.r+=1;let k;function y(){const{delay:S=0,duration:K=300,easing:I=yn,tick:A=He,css:M}=o||sl;M&&(c=ll(e,1,0,K,S,I,M));const E=$n()+S,g=E+K;Ye(()=>rn(e,!1,"start")),"inert"in e&&(k=e.inert,e.inert=!0),el(N=>{if(f){if(N>=g)return A(0,1),rn(e,!1,"end"),--d.r||at(d.c),!1;if(N>=E){const W=I((N-E)/K);A(1-W,W)}}return f})}return fn(o)?il().then(()=>{o=o(l),y()}):y(),{end(S){S&&"inert"in e&&(e.inert=k),S&&o.tick&&o.tick(1,0),f&&(c&&hn(e,c),f=!1)}}}function te(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Cl(e,t,n){const{fragment:l,after_update:o}=e.$$;l&&l.m(t,n),Ye(()=>{const f=e.$$.on_mount.map(Wn).filter(fn);e.$$.on_destroy?e.$$.on_destroy.push(...f):at(f),e.$$.on_mount=[]}),o.forEach(Ye)}function Ml(e,t){const n=e.$$;n.fragment!==null&&(Kl(n.after_update),at(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function El(e,t){e.$$.dirty[0]===-1&&(St.push(e),bl(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Sl(e,t,n,l,o,f,c=null,d=[-1]){const k=bn;qt(e);const y=e.$$={fragment:null,ctx:[],props:f,update:He,not_equal:o,bound:Mn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(k?k.$$.context:[])),callbacks:Mn(),dirty:d,skip_bound:!1,root:t.target||k.$$.root};c&&c(y.root);let S=!1;if(y.ctx=n?n(e,t.props||{},(K,I,...A)=>{const M=A.length?A[0]:I;return y.ctx&&o(y.ctx[K],y.ctx[K]=M)&&(!y.skip_bound&&y.bound[K]&&y.bound[K](M),S&&El(e,K)),I}):[],y.update(),S=!0,at(y.before_update),y.fragment=l?l(y.ctx):!1,t.target){if(t.hydrate){const K=hl(t.target);y.fragment&&y.fragment.l(K),K.forEach(ge)}else y.fragment&&y.fragment.c();t.intro&&mn(e.$$.fragment),Cl(e,t.target,t.anchor),ol()}qt(k)}class Al{constructor(){_n(this,"$$");_n(this,"$$set")}$destroy(){Ml(this,1),this.$destroy=He}$on(t,n){if(!fn(n))return He;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(t){this.$$set&&!_l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ol="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ol);function un(e,{delay:t=0,duration:n=400,easing:l=yn}={}){const o=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:l,css:f=>`opacity: ${f*o}`}}const Ut={"18p":{panel_num:18,panel_width:96,panel_height:96,panel_w_num:5,note_width:20,note_height:6,panel_top:[0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,3],panel_left:[0,1,2,3,4,.5,1.5,2.5,3.5,.5,1.5,2.5,3.5,0,1,2,3,4],colors:["#cccccc","#9999ff","#99ffff","#ffff99","#ff9966","#ffffff"],panel_color_def:[1,2,5,3,4,1,2,3,4,1,2,3,4,1,2,5,3,4],names:"7890-UIOPJKL;NM<>/".split(""),dos_chara:"aa,ab,ac,ad,ae,ba,bb,bc,bd,ca,cb,cc,cd,da,db,dc,dd,de".split(","),key_config:"Digit7,Digit8,Digit9,Digit0,Minus,KeyU,KeyI,KeyO,KeyP,KeyJ,KeyK,KeyL,Semicolon,KeyN,KeyM,Comma,Period,Slash".split(",")},"9t":{panel_num:9,panel_width:96,panel_height:96,panel_w_num:3,note_width:30,note_height:6,panel_top:[0,0,0,1,1,1,2,2,2],panel_left:[0,1,2,0,1,2,0,1,2],colors:["#cccccc","#9999ff","#ff9999","#99ff99"],panel_color_def:[1,1,1,2,3,2,1,1,1],names:"789456123".split(""),dos_chara:"left,down,up,right,space,sleft,sdown,sup,sright".split(","),key_config:"Numpad7,Numpad8,Numpad9,Numpad4,Numpad5,Numpad6,Numpad1,Numpad2,Numpad3".split(",")},"36p":{panel_num:36,panel_width:48,panel_height:48,panel_w_num:10,note_width:15,note_height:6,panel_top:[0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,3,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,3],panel_left:[0,1,2,3,4,.5,1.5,2.5,3.5,.5,1.5,2.5,3.5,0,1,2,3,4,5,6,7,8,9,5.5,6.5,7.5,8.5,5.5,6.5,7.5,8.5,5,6,7,8,9],colors:["#cccccc","#9999ff","#99ffff","#ffff99","#ff9966","#ffffff"],panel_color_def:[1,2,5,3,4,1,2,3,4,1,2,3,4,1,2,5,3,4,1,2,5,3,4,1,2,3,4,1,2,3,4,1,2,5,3,4],names:"23456WERTSDFGZXCVB7890-UIOPJKL;NM<>/".split(""),dos_chara:"aa,ab,ac,ad,ae,ba,bb,bc,bd,ca,cb,cc,cd,da,db,dc,dd,de,af,ag,ah,ai,aj,bf,bg,bh,bi,cf,cg,ch,ci,df,dg,dh,di,dj".split(","),key_config:"Digit2,Digit3,Digit4,Digit5,Digit6,KeyW,KeyE,KeyR,KeyT,KeyS,KeyD,KeyF,KeyG,KeyZ,KeyX,KeyC,KeyV,KeyB,Digit7,Digit8,Digit9,Digit0,Minus,KeyU,KeyI,KeyO,KeyP,KeyJ,KeyK,KeyL,Semicolon,KeyN,KeyM,Comma,Period,Slash".split(",")}};function Ln(e,t,n){const l=e.slice();return l[104]=t[n],l[106]=n,l}function Fn(e,t,n){const l=e.slice();return l[107]=t[n],l[109]=n,l}function Tn(e,t,n){const l=e.slice();return l[104]=t[n],l[106]=n,l}function Rn(e,t,n){const l=e.slice();return l[111]=t[n],l[109]=n,l}function Bn(e,t,n){const l=e.slice();return l[113]=t[n],l[106]=n,l}function jn(e,t,n){const l=e.slice();return l[115]=t[n],l}function In(e,t,n){const l=e.slice();return l[118]=t[n],l}function Vn(e,t,n){const l=e.slice();return l[111]=t[n],l}function Jn(e){let t,n=e[111]+"",l;return{c(){t=p("option"),l=R(n),t.__value=e[111],tt(t,t.__value)},m(o,f){Me(o,t,f),u(t,l)},p:He,d(o){o&&ge(t)}}}function Un(e){let t,n=e[118]+"",l;return{c(){t=p("option"),l=R(n),t.__value=e[118],tt(t,t.__value)},m(o,f){Me(o,t,f),u(t,l)},p:He,d(o){o&&ge(t)}}}function qn(e){let t,n=`${e[0].panel_width-e[115]}px`,l=`${e[0].panel_height-e[115]}px`;return{c(){t=p("div"),t.innerHTML="",i(t,"class","panel_back svelte-1vw65n4"),m(t,"width",n),m(t,"height",l),m(t,"background",e[0].colors[e[0].panel_color_def[e[106]]])},m(o,f){Me(o,t,f)},p(o,f){f[0]&8388609&&n!==(n=`${o[0].panel_width-o[115]}px`)&&m(t,"width",n),f[0]&8388609&&l!==(l=`${o[0].panel_height-o[115]}px`)&&m(t,"height",l),f[0]&1&&m(t,"background",o[0].colors[o[0].panel_color_def[o[106]]])},d(o){o&&ge(t)}}}function Xn(e){let t,n,l,o=e[0].names[e[106]]+"",f,c,d=`${e[0].panel_width+1}px`,k=`${e[0].panel_height+1}px`,y=`${e[0].panel_top[e[106]]*e[0].panel_height}px`,S=`${e[0].panel_left[e[106]]*e[0].panel_width}px`,K,I,A=te(e[23][e[106]]),M=[];for(let E=0;E<A.length;E+=1)M[E]=qn(jn(e,A,E));return{c(){t=p("div");for(let E=0;E<M.length;E+=1)M[E].c();n=C(),l=p("div"),f=R(o),c=C(),i(l,"class","svelte-1vw65n4"),i(t,"class","panel svelte-1vw65n4"),m(t,"width",d),m(t,"height",k),m(t,"top",y),m(t,"left",S),m(t,"background",e[24][e[106]])},m(E,g){Me(E,t,g);for(let N=0;N<M.length;N+=1)M[N]&&M[N].m(t,null);u(t,n),u(t,l),u(l,f),u(t,c),K||(I=w(t,"click",e[37](e[106])),K=!0)},p(E,g){if(e=E,g[0]&8388609){A=te(e[23][e[106]]);let N;for(N=0;N<A.length;N+=1){const W=jn(e,A,N);M[N]?M[N].p(W,g):(M[N]=qn(W),M[N].c(),M[N].m(t,n))}for(;N<M.length;N+=1)M[N].d(1);M.length=A.length}g[0]&1&&o!==(o=e[0].names[e[106]]+"")&&et(f,o),g[0]&1&&d!==(d=`${e[0].panel_width+1}px`)&&m(t,"width",d),g[0]&1&&k!==(k=`${e[0].panel_height+1}px`)&&m(t,"height",k),g[0]&1&&y!==(y=`${e[0].panel_top[e[106]]*e[0].panel_height}px`)&&m(t,"top",y),g[0]&1&&S!==(S=`${e[0].panel_left[e[106]]*e[0].panel_width}px`)&&m(t,"left",S),g[0]&16777216&&m(t,"background",e[24][e[106]])},d(E){E&&ge(t),nt(M,E),K=!1,I()}}}function Hn(e){let t,n,l=`${e[0].note_width+1}px`,o=`${e[25]/e[2]*2/e[5]+1}px`,f=`${e[111]*2/e[5]}px`,c=`${e[106]*e[0].note_width}px`,d,k;function y(){return e[69](e[111])}return{c(){t=p("div"),i(t,"class",n=En(e[109]%(e[2]/4)==0?"grid4":"grid")+" svelte-1vw65n4"),m(t,"width",l),m(t,"height",o),m(t,"top",f),m(t,"left",c)},m(S,K){Me(S,t,K),d||(k=w(t,"click",y),d=!0)},p(S,K){e=S,K[0]&4&&n!==(n=En(e[109]%(e[2]/4)==0?"grid4":"grid")+" svelte-1vw65n4")&&i(t,"class",n),K[0]&1&&l!==(l=`${e[0].note_width+1}px`)&&m(t,"width",l),K[0]&36&&o!==(o=`${e[25]/e[2]*2/e[5]+1}px`)&&m(t,"height",o),K[0]&4194336&&f!==(f=`${e[111]*2/e[5]}px`)&&m(t,"top",f),K[0]&1&&c!==(c=`${e[106]*e[0].note_width}px`)&&m(t,"left",c)},d(S){S&&ge(t),d=!1,k()}}}function Yn(e){let t,n=te(e[22]),l=[];for(let o=0;o<n.length;o+=1)l[o]=Hn(Rn(e,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();t=nl()},m(o,f){for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(o,f);Me(o,t,f)},p(o,f){if(f[0]&37749285|f[1]&1){n=te(o[22]);let c;for(c=0;c<n.length;c+=1){const d=Rn(o,n,c);l[c]?l[c].p(d,f):(l[c]=Hn(d),l[c].c(),l[c].m(t.parentNode,t))}for(;c<l.length;c+=1)l[c].d(1);l.length=n.length}},d(o){o&&ge(t),nt(l,o)}}}function Zn(e){let t,n=`${e[16]*2/e[5]}px`,l=`${e[0].note_width*e[0].panel_num}px`;return{c(){t=p("div"),t.innerHTML="",i(t,"class","cursor_play svelte-1vw65n4"),m(t,"top",n),m(t,"width",l)},m(o,f){Me(o,t,f)},p(o,f){f[0]&65568&&n!==(n=`${o[16]*2/o[5]}px`)&&m(t,"top",n),f[0]&1&&l!==(l=`${o[0].note_width*o[0].panel_num}px`)&&m(t,"width",l)},d(o){o&&ge(t)}}}function zn(e){let t,n=`${e[0].note_width+1}px`,l=`${e[0].note_height}px`,o=`${e[107]*2/e[5]-e[0].note_height/2}px`,f=`${e[106]*e[0].note_width}px`;return{c(){t=p("div"),t.innerHTML="",i(t,"class","note svelte-1vw65n4"),m(t,"width",n),m(t,"height",l),m(t,"top",o),m(t,"left",f),m(t,"background",e[0].colors[e[0].panel_color_def[e[106]]])},m(c,d){Me(c,t,d)},p(c,d){d[0]&1&&n!==(n=`${c[0].note_width+1}px`)&&m(t,"width",n),d[0]&1&&l!==(l=`${c[0].note_height}px`)&&m(t,"height",l),d[0]&1048609&&o!==(o=`${c[107]*2/c[5]-c[0].note_height/2}px`)&&m(t,"top",o),d[0]&1&&f!==(f=`${c[106]*c[0].note_width}px`)&&m(t,"left",f),d[0]&1&&m(t,"background",c[0].colors[c[0].panel_color_def[c[106]]])},d(c){c&&ge(t)}}}function Gn(e){let t,n=te(e[104]),l=[];for(let o=0;o<n.length;o+=1)l[o]=zn(Fn(e,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();t=nl()},m(o,f){for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(o,f);Me(o,t,f)},p(o,f){if(f[0]&1048609){n=te(o[104]);let c;for(c=0;c<n.length;c+=1){const d=Fn(o,n,c);l[c]?l[c].p(d,f):(l[c]=zn(d),l[c].c(),l[c].m(t.parentNode,t))}for(;c<l.length;c+=1)l[c].d(1);l.length=n.length}},d(o){o&&ge(t),nt(l,o)}}}function Pl(e){let t,n,l,o;return{c(){t=p("div"),t.textContent="ページの途中にラベルがあるため曲再生が正常にできない可能性があります。",i(t,"class","message svelte-1vw65n4"),m(t,"background",e[28].warning)},m(f,c){Me(f,t,c),o=!0},p:He,i(f){o||(f&&Ye(()=>{o&&(l&&l.end(1),n=rl(t,un,{duration:100}),n.start())}),o=!0)},o(f){n&&n.invalidate(),f&&(l=ul(t,un,{duration:300})),o=!1},d(f){f&&ge(t),f&&l&&l.end()}}}function Ll(e){let t,n,l,o,f,c,d;return{c(){t=p("div"),n=R(e[13]),i(t,"class","message svelte-1vw65n4"),m(t,"background",e[14])},m(k,y){Me(k,t,y),u(t,n),f=!0,c||(d=w(t,"click",e[73]),c=!0)},p(k,y){(!f||y[0]&8192)&&et(n,k[13]),y[0]&16384&&m(t,"background",k[14])},i(k){f||(k&&Ye(()=>{f&&(o&&o.end(1),l=rl(t,un,{duration:100}),l.start())}),f=!0)},o(k){l&&l.invalidate(),k&&(o=ul(t,un,{duration:300})),f=!1},d(k){k&&ge(t),k&&o&&o.end(),c=!1,d()}}}function Fl(e){let t,n,l,o=e[8]+1+"",f,c,d=(e[1]-e[8]*192)/(e[25]/e[2])+1+"",k,y,S,K,I=Math.round(e[19])+"",A,M,E,g,N,W,Re,Ee,Pt,ct,Lt,De,fe,B,an,Q,Se,F,Be,O,V,J,me,P,q,ot,h,$,T,ae,_t,ce,Ze,x,je,_e,pt,z,dt,G,ze,ve,Ft,Le,Ge,j,We,ye,Tt,Fe,Ne,ee,we,Ie,Xt,Te,ne,Ae,Rt,Ve,Oe,Qe,Bt,le,ht,it,Pe,gt=`${(e[1]-e[9]*e[25]*e[5])*2/e[5]}px`,st=`${e[0].note_width*e[0].panel_num}px`,jt,mt=`${e[25]*2+10}px`,vt,pe,Ht,yt=e[17].toFixed(2)+"",It,Yt,be,Zt,wt=e[18].toFixed(2)+"",Vt,bt,ke,zt,$e,Gt,X,Je,Wt,Ue,Qt,qe,$t,Xe,s,a,D,b,Ce,U,Ke,rt,H,Y,kn,kt,ut,Kn,ft,cn,Dn,Kt=te(e[26]),oe=[];for(let r=0;r<Kt.length;r+=1)oe[r]=Jn(Vn(e,Kt,r));let Dt=te(e[27]),ie=[];for(let r=0;r<Dt.length;r+=1)ie[r]=Un(In(e,Dt,r));let Nt=te(e[3]),se=[];for(let r=0;r<Nt.length;r+=1)se[r]=Xn(Bn(e,Nt,r));let Ct=te(e[20]),re=[];for(let r=0;r<Ct.length;r+=1)re[r]=Yn(Tn(e,Ct,r));let de=e[16]>=0&&Zn(e),Mt=te(e[20]),ue=[];for(let r=0;r<Mt.length;r+=1)ue[r]=Gn(Ln(e,Mt,r));const Nn=[Ll,Pl],xe=[];function Cn(r,v){return r[13]!==""?0:r[21]?1:-1}return~(H=Cn(e))&&(Y=xe[H]=Nn[H](e)),{c(){t=p("main"),n=p("div"),l=p("div"),f=R(o),c=R("小節目, "),k=R(d),y=R("/"),S=R(e[2]),K=R(" ("),A=R(I),M=R("f)"),E=C(),g=p("div"),N=p("input"),Re=C(),Ee=p("label"),Ee.textContent="この小節で設定変更",Pt=R(` |\r
      `),ct=p("label"),ct.textContent="開始フレーム:",Lt=C(),De=p("input"),fe=C(),B=p("label"),B.textContent="BPM:",an=C(),Q=p("input"),Se=R(` |\r
      `),F=p("input"),Be=C(),O=p("label"),O.textContent="パネル表示を逆転(R)",V=p("br"),J=R(`\r
      1ページの小節数\r
      `),me=p("select");for(let r=0;r<oe.length;r+=1)oe[r].c();P=R(`\r
      | パネル表示倍率\r
      `),q=p("select");for(let r=0;r<ie.length;r+=1)ie[r].c();ot=C(),h=p("div"),$=p("input"),T=C(),ae=p("input"),_t=C(),ce=p("input"),Ze=C(),x=p("input"),je=C(),_e=p("input"),pt=C(),z=p("input"),dt=C(),G=p("input"),ze=C(),ve=p("input"),Ft=C(),Le=p("input"),Ge=C(),j=p("input"),We=C(),ye=p("input"),Tt=C(),Fe=p("input"),Ne=C(),ee=p("input"),we=C(),Ie=p("input"),Xt=C(),Te=p("input"),ne=C(),Ae=p("input"),Rt=C(),Ve=p("div"),Oe=p("div");for(let r=0;r<se.length;r+=1)se[r].c();Bt=C(),le=p("div");for(let r=0;r<re.length;r+=1)re[r].c();ht=C(),de&&de.c(),it=C(),Pe=p("div"),Pe.innerHTML="",jt=C();for(let r=0;r<ue.length;r+=1)ue[r].c();vt=C(),pe=p("div"),Ht=R("音量("),It=R(yt),Yt=R(`)\r
      `),be=p("input"),Zt=R(`\r
      速度(`),Vt=R(wt),bt=R(`)\r
      `),ke=p("input"),zt=C(),$e=p("div"),$e.textContent="画面にファイルをドロップしてセーブデータ/音楽ファイルを読み込み",Gt=C(),X=p("div"),Je=p("input"),Wt=C(),Ue=p("input"),Qt=C(),qe=p("input"),$t=C(),Xe=p("input"),s=C(),a=p("input"),D=C(),b=p("input"),Ce=R(`\r
      譜面番号`),U=p("input"),Ke=C(),rt=p("div"),Y&&Y.c(),kn=C(),kt=p("footer"),ut=p("a"),ut.textContent="使用しているソフトウェアのライセンス表示",Kn=R(` |\r
      `),ft=p("a"),ft.textContent=`Pun◇Pane Editor Ver.${vn}`,i(N,"type","checkbox"),N.checked=W=e[11]===e[8],i(N,"id","fix"),i(Ee,"for","fix"),i(Ee,"class","svelte-1vw65n4"),i(ct,"for","begin_frame"),i(ct,"class","svelte-1vw65n4"),i(De,"type","number"),De.value=e[10],i(De,"id","begin_frame"),i(De,"class","svelte-1vw65n4"),i(B,"for","bpm"),i(B,"class","svelte-1vw65n4"),i(Q,"type","number"),Q.value=e[7],i(Q,"step","0.01"),i(Q,"min","0.01"),i(Q,"id","bpm"),i(Q,"class","svelte-1vw65n4"),i(F,"type","checkbox"),i(F,"id","panel_reverse"),i(O,"for","panel_reverse"),i(O,"title","Rキー: カーソルより前のパネルを表示するか後のパネルを表示するかの切り替え"),i(O,"class","svelte-1vw65n4"),i(me,"class","svelte-1vw65n4"),e[5]===void 0&&Ye(()=>e[67].call(me)),i(q,"class","svelte-1vw65n4"),e[6]===void 0&&Ye(()=>e[68].call(q)),i(g,"class","main_input svelte-1vw65n4"),i($,"type","button"),$.value="4",i($,"title","1キー: カーソル移動間隔を4分に変更"),i($,"class","svelte-1vw65n4"),Z($,"selected",e[2]===4),i(ae,"type","button"),ae.value="8",i(ae,"title","2キー: カーソル移動間隔を8分に変更"),i(ae,"class","svelte-1vw65n4"),Z(ae,"selected",e[2]===8),i(ce,"type","button"),ce.value="16",i(ce,"title","3キー: カーソル移動間隔を16分に変更"),i(ce,"class","svelte-1vw65n4"),Z(ce,"selected",e[2]===16),i(x,"type","button"),x.value="32",i(x,"title","7/Eキー: カーソル移動間隔を32分に変更"),i(x,"class","svelte-1vw65n4"),Z(x,"selected",e[2]===32),i(_e,"type","button"),_e.value="12",i(_e,"title","4キー: カーソル移動間隔を12分(8分3連)に変更"),i(_e,"class","svelte-1vw65n4"),Z(_e,"selected",e[2]===12),i(z,"type","button"),z.value="24",i(z,"title","5キー: カーソル移動間隔を24分(16分3連)に変更"),i(z,"class","svelte-1vw65n4"),Z(z,"selected",e[2]===24),i(G,"type","button"),G.value="48",i(G,"title","6キー: カーソル移動間隔を48分(32分3連)に変更"),i(G,"class","svelte-1vw65n4"),Z(G,"selected",e[2]===48),i(ve,"type","button"),ve.value="←",i(ve,"title","左矢印キー: 前のページに移動"),i(ve,"class","svelte-1vw65n4"),i(Le,"type","button"),Le.value="↑",i(Le,"title","上矢印/B: カーソルを上に移動"),i(Le,"class","svelte-1vw65n4"),i(j,"type","button"),j.value="↓",i(j,"title","下矢印/スペース: カーソルを下に移動"),i(j,"class","svelte-1vw65n4"),i(ye,"type","button"),ye.value="→",i(ye,"title","右矢印キー: 次のページに移動"),i(ye,"class","svelte-1vw65n4"),i(Fe,"type","button"),Fe.value="BS",i(Fe,"title","Backspace: カーソルを前に移動してパネルを削除"),i(Fe,"class","svelte-1vw65n4"),i(ee,"type","button"),ee.value="Del",i(ee,"title","Delete: カーソルのある行のパネルを削除"),i(ee,"class","svelte-1vw65n4"),i(Ie,"type","button"),Ie.value="↶",i(Ie,"title","Ctrl+Z: 元に戻す"),i(Ie,"class","svelte-1vw65n4"),i(Te,"type","button"),Te.value="↷",i(Te,"title","Ctrl+Y: やり直す"),i(Te,"class","svelte-1vw65n4"),i(Ae,"type","button"),Ae.value="♪",i(Ae,"title","Enter: 曲再生の開始/停止"),i(Ae,"class","svelte-1vw65n4"),i(h,"class","main_buttons svelte-1vw65n4"),i(Oe,"class","panels svelte-1vw65n4"),i(Oe,"style",Qe=`left: ${e[0].note_width*e[0].panel_num+20}px; width: ${e[0].panel_width*5}px;`),i(Pe,"class","cursor svelte-1vw65n4"),m(Pe,"top",gt),m(Pe,"width",st),i(le,"class","notes svelte-1vw65n4"),i(Ve,"class","punpane_editor svelte-1vw65n4"),m(Ve,"height",mt),i(be,"type","range"),i(be,"min","0"),i(be,"max","1"),i(be,"step","0.01"),i(ke,"type","range"),i(ke,"min","0.1"),i(ke,"max","1.5"),i(ke,"step","0.1"),i(pe,"class","music_control svelte-1vw65n4"),i($e,"class","drop_area svelte-1vw65n4"),Z($e,"dragover",e[15]),i(Je,"type","button"),Je.value="新規作成",i(Je,"title","編集中の譜面データを初期化します"),i(Je,"class","svelte-1vw65n4"),i(Ue,"type","button"),Ue.value="コピー(C)",i(Ue,"title","Ctrl+C: 現在のページ内容をクリップボードにコピーします。"),i(Ue,"class","svelte-1vw65n4"),i(qe,"type","button"),qe.value="切り取り(X)",i(qe,"title","Ctrl+X: 現在のページ内容をクリップボードに切り取ります。"),i(qe,"class","svelte-1vw65n4"),i(Xe,"type","button"),Xe.value="貼り付け/読み込み(V)",i(Xe,"title","Ctrl+V: コピーした内容を貼り付けます。クリップボードにセーブデータがある場合、それを読み込みます。"),i(Xe,"class","svelte-1vw65n4"),i(a,"type","button"),a.value="セーブ(S)",i(a,"title","Ctrl+S: セーブデータをクリップボードにコピーします。"),i(a,"class","svelte-1vw65n4"),i(b,"type","button"),b.value="dos出力(D)",i(b,"title","Ctrl+D: dosデータをクリップボードにコピーします。"),i(b,"class","svelte-1vw65n4"),i(U,"type","number"),i(U,"min","1"),i(U,"class","svelte-1vw65n4"),i(X,"class","save_buttons svelte-1vw65n4"),i(rt,"class","message_container svelte-1vw65n4"),i(ut,"href","./thirdparty_license.txt"),i(ut,"target","_blank"),i(ut,"rel","noopener noreferrer"),i(ut,"class","svelte-1vw65n4"),i(ft,"href","https://github.com/suzme/punpane-editor"),i(ft,"target","_blank"),i(ft,"rel","noopener noreferrer"),i(ft,"class","svelte-1vw65n4"),i(kt,"class","svelte-1vw65n4"),i(n,"class","container svelte-1vw65n4"),Z(n,"dragover",e[15]),m(n,"width",`${e[0].note_width*e[0].panel_num+20+e[0].panel_width*e[0].panel_w_num}px`)},m(r,v){Me(r,t,v),u(t,n),u(n,l),u(l,f),u(l,c),u(l,k),u(l,y),u(l,S),u(l,K),u(l,A),u(l,M),u(n,E),u(n,g),u(g,N),u(g,Re),u(g,Ee),u(g,Pt),u(g,ct),u(g,Lt),u(g,De),u(g,fe),u(g,B),u(g,an),u(g,Q),u(g,Se),u(g,F),F.checked=e[4],u(g,Be),u(g,O),u(g,V),u(g,J),u(g,me);for(let L=0;L<oe.length;L+=1)oe[L]&&oe[L].m(me,null);xt(me,e[5],!0),u(g,P),u(g,q);for(let L=0;L<ie.length;L+=1)ie[L]&&ie[L].m(q,null);xt(q,e[6],!0),u(n,ot),u(n,h),u(h,$),u(h,T),u(h,ae),u(h,_t),u(h,ce),u(h,Ze),u(h,x),u(h,je),u(h,_e),u(h,pt),u(h,z),u(h,dt),u(h,G),u(h,ze),u(h,ve),u(h,Ft),u(h,Le),u(h,Ge),u(h,j),u(h,We),u(h,ye),u(h,Tt),u(h,Fe),u(h,Ne),u(h,ee),u(h,we),u(h,Ie),u(h,Xt),u(h,Te),u(h,ne),u(h,Ae),u(n,Rt),u(n,Ve),u(Ve,Oe);for(let L=0;L<se.length;L+=1)se[L]&&se[L].m(Oe,null);u(Ve,Bt),u(Ve,le);for(let L=0;L<re.length;L+=1)re[L]&&re[L].m(le,null);u(le,ht),de&&de.m(le,null),u(le,it),u(le,Pe),u(le,jt);for(let L=0;L<ue.length;L+=1)ue[L]&&ue[L].m(le,null);u(n,vt),u(n,pe),u(pe,Ht),u(pe,It),u(pe,Yt),u(pe,be),tt(be,e[17]),u(pe,Zt),u(pe,Vt),u(pe,bt),u(pe,ke),tt(ke,e[18]),u(n,zt),u(n,$e),u(n,Gt),u(n,X),u(X,Je),u(X,Wt),u(X,Ue),u(X,Qt),u(X,qe),u(X,$t),u(X,Xe),u(X,s),u(X,a),u(X,D),u(X,b),u(X,Ce),u(X,U),tt(U,e[12]),u(n,Ke),u(n,rt),~H&&xe[H].m(rt,null),u(n,kn),u(n,kt),u(kt,ut),u(kt,Kn),u(kt,ft),cn||(Dn=[w(window,"beforeunload",e[57]),w(window,"keydown",e[55]),w(window,"wheel",e[56]),w(window,"drop",e[54]),w(window,"dragover",e[52]),w(window,"dragleave",e[53]),w(N,"change",e[49]),w(De,"change",e[50]),w(Q,"change",e[51]),w(F,"change",e[66]),w(me,"change",e[67]),w(q,"change",e[68]),w($,"click",e[36](4)),w(ae,"click",e[36](8)),w(ce,"click",e[36](16)),w(x,"click",e[36](32)),w(_e,"click",e[36](12)),w(z,"click",e[36](24)),w(G,"click",e[36](48)),w(ve,"click",e[34]),w(Le,"click",e[32]),w(j,"click",e[33]),w(ye,"click",e[35]),w(Fe,"click",e[39]),w(ee,"click",e[38]),w(Ie,"click",e[29]),w(Te,"click",e[30]),w(Ae,"click",e[46]),w(be,"change",e[70]),w(be,"input",e[70]),w(be,"input",e[47]),w(ke,"change",e[71]),w(ke,"input",e[71]),w(ke,"input",e[48]),w(Je,"click",e[40]),w(Ue,"click",e[41]),w(qe,"click",e[42]),w(Xe,"click",e[44]),w(a,"click",e[43]),w(b,"click",e[45]),w(U,"input",e[72])],cn=!0)},p(r,v){if(v[0]&256&&o!==(o=r[8]+1+"")&&et(f,o),v[0]&262&&d!==(d=(r[1]-r[8]*192)/(r[25]/r[2])+1+"")&&et(k,d),v[0]&4&&et(S,r[2]),v[0]&524288&&I!==(I=Math.round(r[19])+"")&&et(A,I),v[0]&2304&&W!==(W=r[11]===r[8])&&(N.checked=W),v[0]&1024&&De.value!==r[10]&&(De.value=r[10]),v[0]&128&&Q.value!==r[7]&&(Q.value=r[7]),v[0]&16&&(F.checked=r[4]),v[0]&67108864){Kt=te(r[26]);let _;for(_=0;_<Kt.length;_+=1){const he=Vn(r,Kt,_);oe[_]?oe[_].p(he,v):(oe[_]=Jn(he),oe[_].c(),oe[_].m(me,null))}for(;_<oe.length;_+=1)oe[_].d(1);oe.length=Kt.length}if(v[0]&67108896&&xt(me,r[5]),v[0]&134217728){Dt=te(r[27]);let _;for(_=0;_<Dt.length;_+=1){const he=In(r,Dt,_);ie[_]?ie[_].p(he,v):(ie[_]=Un(he),ie[_].c(),ie[_].m(q,null))}for(;_<ie.length;_+=1)ie[_].d(1);ie.length=Dt.length}if(v[0]&134217792&&xt(q,r[6]),v[0]&4&&Z($,"selected",r[2]===4),v[0]&4&&Z(ae,"selected",r[2]===8),v[0]&4&&Z(ce,"selected",r[2]===16),v[0]&4&&Z(x,"selected",r[2]===32),v[0]&4&&Z(_e,"selected",r[2]===12),v[0]&4&&Z(z,"selected",r[2]===24),v[0]&4&&Z(G,"selected",r[2]===48),v[0]&25165833|v[1]&64){Nt=te(r[3]);let _;for(_=0;_<Nt.length;_+=1){const he=Bn(r,Nt,_);se[_]?se[_].p(he,v):(se[_]=Xn(he),se[_].c(),se[_].m(Oe,null))}for(;_<se.length;_+=1)se[_].d(1);se.length=Nt.length}if(v[0]&1&&Qe!==(Qe=`left: ${r[0].note_width*r[0].panel_num+20}px; width: ${r[0].panel_width*5}px;`)&&i(Oe,"style",Qe),v[0]&38797861|v[1]&1){Ct=te(r[20]);let _;for(_=0;_<Ct.length;_+=1){const he=Tn(r,Ct,_);re[_]?re[_].p(he,v):(re[_]=Yn(he),re[_].c(),re[_].m(le,ht))}for(;_<re.length;_+=1)re[_].d(1);re.length=Ct.length}if(r[16]>=0?de?de.p(r,v):(de=Zn(r),de.c(),de.m(le,it)):de&&(de.d(1),de=null),v[0]&546&&gt!==(gt=`${(r[1]-r[9]*r[25]*r[5])*2/r[5]}px`)&&m(Pe,"top",gt),v[0]&1&&st!==(st=`${r[0].note_width*r[0].panel_num}px`)&&m(Pe,"width",st),v[0]&1048609){Mt=te(r[20]);let _;for(_=0;_<Mt.length;_+=1){const he=Ln(r,Mt,_);ue[_]?ue[_].p(he,v):(ue[_]=Gn(he),ue[_].c(),ue[_].m(le,null))}for(;_<ue.length;_+=1)ue[_].d(1);ue.length=Mt.length}v[0]&131072&&yt!==(yt=r[17].toFixed(2)+"")&&et(It,yt),v[0]&131072&&tt(be,r[17]),v[0]&262144&&wt!==(wt=r[18].toFixed(2)+"")&&et(Vt,wt),v[0]&262144&&tt(ke,r[18]),v[0]&32768&&Z($e,"dragover",r[15]),v[0]&4096&&nn(U.value)!==r[12]&&tt(U,r[12]);let L=H;H=Cn(r),H===L?~H&&xe[H].p(r,v):(Y&&(Dl(),Pn(xe[L],1,1,()=>{xe[L]=null}),Nl()),~H?(Y=xe[H],Y?Y.p(r,v):(Y=xe[H]=Nn[H](r),Y.c()),mn(Y,1),Y.m(rt,null)):Y=null),v[0]&32768&&Z(n,"dragover",r[15]),v[0]&1&&m(n,"width",`${r[0].note_width*r[0].panel_num+20+r[0].panel_width*r[0].panel_w_num}px`)},i(r){mn(Y)},o(r){Pn(Y)},d(r){r&&ge(t),nt(oe,r),nt(ie,r),nt(se,r),nt(re,r),de&&de.d(),nt(ue,r),~H&&xe[H].d(),cn=!1,at(Dn)}}}const vn="20240131-1",Tl=100,dn=0,en=200,tn=160;function Rl(e,t,n){let l,o,f,c,d,k,y,S,K,I,A,M,E,g,N,W,Re,Ee,Pt;const Lt=[1,2,4],De=["1/4","1/2","1","2","4"],fe={success:"#99ccff",error:"#ffcccc",warning:"#ffffcc"};let B={};const Q=new URL(document.location.toString()).searchParams.get("key");Q&&Ut[Q]?B={...Ut[Q],key:Q}:B={...Ut["18p"],key:"18p"};let Se=1,F=0,Be=16,O=[0],V=[en],J=[tn],me=null,P="",q=fe.success,ot=!1,h=new Array(B.panel_num).fill([]),$,T=1,ae="1",_t,ce=-1,Ze=1,x=1;const je=new AudioContext,_e=je.createGain();_e.connect(je.destination);let pt,z,dt=!1,G=!1,ze=[],ve=[];const Ft=()=>{const s=ze.pop();s&&(s.undo?s.undo():(n(13,P="不正なコマンドです。"),n(14,q=fe.error),console.log(s)),ve.push(s))},Le=()=>{const s=ve.pop();s&&(s.redo?s.redo():s.do?s.do():(n(13,P="不正なコマンドです。"),n(14,q=fe.error),console.log(s)),ze.push(s))},Ge=s=>{s.do?(ve=[],ze.push(s),s.do()):(n(13,P="不正なコマンドです。"),n(14,q=fe.error),console.log(s))},j=s=>{n(13,P=""),G&&Math.floor(s/(192*T))!==Math.floor(F/(192*T))&&setTimeout(mt,0),n(1,F=s)},We=()=>j(F-3*64/Be),ye=()=>j(F+3*64/Be),Tt=()=>j((o-1)*T*192),Fe=()=>j((o+1)*T*192),Ne=s=>()=>{n(13,P=""),n(2,Be=s),n(1,F=Math.floor(F/(192/s))*(192/s))},ee=(s,a)=>{n(3,h[s]=[...h[s],a],h)},we=(s,a)=>{n(3,h[s]=h[s].filter(D=>D!==a),h)},Ie=(s,a)=>{Ge({do:()=>{ee(s,a)},redo:()=>{ee(s,a),j(a)},undo:()=>{we(s,a),j(a)}})},Xt=(s,a)=>{Ge({do:()=>{we(s,a)},redo:()=>{we(s,a),j(a)},undo:()=>{ee(s,a),j(a)}})},Te=s=>()=>{n(13,P=""),h[s].includes(F)?Xt(s,F):Ie(s,F),me===null&&(me=setTimeout(()=>{me=null,ye()},Tl))},ne=(s,a)=>{s.forEach((D,b)=>{D.forEach(Ce=>{a(b,Ce)})})},Ae=()=>{n(13,P="");const s=F,a=h.map(D=>D.filter(b=>b===s));Ge({do:()=>{ne(a,we)},redo:()=>{ne(a,we),j(s)},undo:()=>{ne(a,ee),j(s)}})},Rt=()=>{We(),Ae()},Ve=()=>{confirm("現在編集中のデータは失われます。よろしいですか？")!==!1&&(n(3,h=new Array(B.panel_num).fill([])),ze=[],ve=[],n(58,O=[]),n(59,V=[]),n(60,J=[]),n(12,Se=1),n(1,F=0),n(13,P=""))},Oe=(s,a="クリップボードにコピーしました。")=>{navigator.clipboard?(navigator.clipboard.writeText(s),n(13,P=a),n(14,q=fe.success)):prompt("コピーして保存してください。",s)},Qe=()=>{Oe(JSON.stringify({title:"punpane-editor-copy",editor_version:vn,copy_data_version:1,resolution:192,key:B.key,panels:W}),"クリップボードに現在のページをコピーしました。")},Bt=()=>{Qe();const s=o*T*192,a=h.map(D=>D.filter(b=>o*T*192<=b&&b<(o+1)*T*192));Ge({do:()=>{ne(a,we)},redo:()=>{ne(a,we),j(s)},undo:()=>{ne(a,ee),j(s)}}),n(13,P="クリップボードに現在のページをコピーしました。")},le=()=>JSON.stringify({title:"punpane-editor-save",key:B.key,panels:h,label_measures:O,begin_frames:V,bpms:J,resolution:192,chart_num:Se,editor_version:vn,save_data_version:2}),ht=()=>Oe(le(),"クリップボードにセーブデータをコピーしました。"),it=s=>{let a;try{a=JSON.parse(s)}catch(D){console.log(D),n(13,P="セーブデータの読み込みに失敗しました。"),n(14,q=fe.error);return}if(a.title==="punpane-editor-copy"){const D=a.panels,b=o*T*192,Ce=h.map(U=>U.filter(Ke=>o*T*192<=Ke&&Ke<(o+1)*T*192));Ge({do:()=>{ne(Ce,we),ne(D,(U,Ke)=>ee(U,Ke+b))},redo:()=>{ne(Ce,we),ne(D,(U,Ke)=>ee(U,Ke+b)),j(b)},undo:()=>{ne(D,(U,Ke)=>we(U,Ke+b)),ne(Ce,ee),j(b)}});return}if(a.save_data_version!==1&&a.title!=="punpane-editor-save"){n(13,P="セーブデータの形式が不正です"),n(14,q=fe.error);return}confirm("セーブデータを読み込むと現在編集中のデータは失われます。よろしいですか？")!==!1&&(a.key?(n(0,B={...Ut[a.key]}),n(0,B.key=a.key,B)):(n(0,B={...Ut["18p"]}),n(0,B.key="18p",B)),n(1,F=0),n(3,h=a.panels??new Array(B.panel_num).fill([])),ze=[],ve=[],n(58,O=a.label_measures??[]),n(59,V=a.begin_frames??[]),n(60,J=a.bpms??[]),n(12,Se=a.chart_num),n(13,P="セーブデータを読み込みました。"))},Pe=()=>{if(navigator.clipboard)navigator.clipboard.readText().then(s=>it(s));else{const s=prompt("セーブデータを貼り付けてください。");s&&s!==""&&it(s)}},gt=()=>h.map((s,a)=>`|${B.dos_chara[a]}${Se!==1?Se:""}_data=`+[...s.map(D=>{const b=Math.floor(D/192),Ce=Math.max(...O.filter(Y=>b>=Y)),U=O.findIndex(Y=>Y===Ce),Ke=O[U]??O[0]??dn,rt=V[U]??V[0]??en,H=J[U]??J[0]??tn;return Math.round((D-Ke*192)/192*4*60*60/H+rt)})].sort().join(",")).join("")+"|",st=()=>Oe(gt(),"クリップボードにdosをコピーしました。"),jt=()=>{G&&(n(16,ce=((je.currentTime-_t)*A*x/60/4-.5)*192),ce>192*T&&(vt(),mt()),requestAnimationFrame(jt))},mt=()=>{if(G&&vt(),dt){const a=((o*T-S-.5)*4*60*60/M+I-200)/60,D=a<0?-a:0;_e.gain.value=Ze,z=je.createBufferSource(),z.buffer=pt,z.playbackRate.value=x,z.connect(_e),_t=je.currentTime+D,z.start(_t+D,Math.max(a,0)),requestAnimationFrame(jt),G=!0}else pt?n(13,P="再生準備が未完了です。"):n(13,P="音楽ファイルが入力されていません。"),n(14,q=fe.error)},vt=()=>{z.stop(),n(16,ce=-1),G=!1},pe=()=>{G?vt():mt()},Ht=()=>{_e.gain.value=Ze},yt=()=>{z.playbackRate.value=x,G&&mt()},It=s=>{if(n(13,P=""),s.target.checked)n(58,O=[...O,l]),n(59,V=[...V,Math.round(E)]),n(60,J=[...J,A]);else{const a=d;n(58,O=O.filter((D,b)=>a!==b)),n(59,V=V.filter((D,b)=>a!==b)),n(60,J=J.filter((D,b)=>a!==b))}},Yt=s=>{n(13,P="");const a=s.target.value;let D;try{D=parseFloat(a)}catch(b){console.log(b),b.target.value=V[d];return}Number.isNaN(D)?s.target.value=V[d]:n(59,V[d]=D,V)},be=s=>{n(13,P="");const a=s.target.value;let D;try{D=parseFloat(a)}catch(b){console.log(b),b.target.value=J[d];return}Number.isNaN(D)||D<=0?s.target.value=J[d]:n(60,J[d]=D,J)},Zt=s=>{s.preventDefault(),n(15,ot=!0),n(13,P="")},wt=s=>{s.preventDefault(),n(15,ot=!1),n(13,P="")},Vt=s=>{if(s.stopPropagation(),s.preventDefault(),n(15,ot=!1),n(13,P=""),!s.dataTransfer||!s.dataTransfer.files)return;const a=s.dataTransfer.files;if(a.length===0)return;const D=a[0];if(D.type.match(/^audio/)){dt=!1;const b=new FileReader;b.onload=()=>{typeof b.result!="string"&&je.decodeAudioData(b.result,Ce=>{pt=Ce,n(13,P="音楽ファイルの読み込みが完了しました。"),n(14,q=fe.success),dt=!0})},b.readAsArrayBuffer(D)}else if(D.type==="text/plain"){const b=new FileReader;b.onload=()=>{it(b.result)},b.readAsText(D)}else n(13,P="非対応のファイルタイプです("+D.type+")"),n(14,q=fe.error)},bt={ArrowUp:We,ArrowDown:ye,ArrowLeft:Tt,ArrowRight:Fe,KeyB:We,Space:ye,Digit1:Ne(4),Digit2:Ne(8),Digit3:Ne(16),Digit4:Ne(12),Digit5:Ne(24),Digit6:Ne(48),Digit7:Ne(32),KeyE:Ne(32),Delete:Ae,Backspace:Rt,KeyR:()=>n(4,$=!$),Enter:pe},ke=Object.assign({KeyZ:Ft,KeyY:Le,KeyC:Qe,KeyX:Bt,KeyV:Pe,KeyS:ht,KeyD:st},bt);B.key_config.forEach((s,a)=>bt[s]=Te(a));const zt=s=>{if(s.target.type!=="number"){const a=s.ctrlKey?ke:bt;a[s.code]&&(a[s.code](),s.preventDefault())}},$e=s=>{s.deltaY>0?ye():s.deltaY<0&&We()},Gt=s=>{s.preventDefault(),s.returnValue="ページを移動してよろしいですか？現在編集中のデータは失われます。"};function X(){$=this.checked,n(4,$)}function Je(){T=Sn(this),n(5,T),n(26,Lt)}function Wt(){ae=Sn(this),n(6,ae),n(27,De)}const Ue=s=>j(o*192*T+s);function Qt(){Ze=nn(this.value),n(17,Ze)}function qe(){x=nn(this.value),n(18,x)}function $t(){Se=nn(this.value),n(12,Se)}const Xe=()=>n(13,P="");return e.$$.update=()=>{e.$$.dirty[0]&2&&n(8,l=Math.floor(F/192)),e.$$.dirty[0]&34&&n(9,o=Math.floor(F/192/T)),e.$$.dirty[0]&256|e.$$.dirty[1]&134217728&&n(65,f=Math.max(...O.filter(s=>l>=s))),e.$$.dirty[0]&544|e.$$.dirty[1]&134217728&&n(64,c=Math.max(...O.filter(s=>o*T>=s))),e.$$.dirty[1]&134217728|e.$$.dirty[2]&8&&n(61,d=O.findIndex(s=>s===f)),e.$$.dirty[1]&134217728|e.$$.dirty[2]&4&&n(63,k=O.findIndex(s=>s===c)),e.$$.dirty[1]&1207959552&&n(11,y=O[d]??O[0]??dn),e.$$.dirty[1]&134217728|e.$$.dirty[2]&2&&(S=O[k]??O[0]??dn),e.$$.dirty[1]&1342177280&&n(10,K=V[d]??V[0]??en),e.$$.dirty[1]&268435456|e.$$.dirty[2]&2&&(I=V[k]??V[0]??en),e.$$.dirty[1]&1610612736&&n(7,A=J[d]??J[0]??tn),e.$$.dirty[1]&536870912|e.$$.dirty[2]&2&&(M=J[k]??J[0]??tn),e.$$.dirty[0]&3202&&n(19,E=(F-y*192)/192*4*60*60/A+K),e.$$.dirty[0]&64&&n(62,g=(()=>{const s=ae.split("/");return s.length===1?parseFloat(s[0]):parseFloat(s[0])/parseFloat(s[1])})()),e.$$.dirty[0]&11&&n(24,N=h.map((s,a)=>s.includes(F)?B.colors[B.panel_color_def[a]]:B.colors[0])),e.$$.dirty[0]&552&&n(20,W=h.map(s=>s.map(a=>a-o*T*192).filter(a=>a>=0&&a<192*T))),e.$$.dirty[0]&26|e.$$.dirty[2]&1&&n(23,Re=h.map(s=>$?s.map(a=>(a-F)*g).filter(a=>a>0&&a<=96):s.map(a=>(F-a)*g).filter(a=>a>0&&a<=96))),e.$$.dirty[0]&36&&n(22,Ee=new Array(Be*T).fill(0).map((s,a)=>192/Be*a)),e.$$.dirty[0]&544|e.$$.dirty[1]&134217728&&n(21,Pt=O.filter(s=>o*T<s&&s<(o+1)*T).length>0)},[B,F,Be,h,$,T,ae,A,l,o,K,y,Se,P,q,ot,ce,Ze,x,E,W,Pt,Ee,Re,N,192,Lt,De,fe,Ft,Le,j,We,ye,Tt,Fe,Ne,Te,Ae,Rt,Ve,Qe,Bt,ht,Pe,st,pe,Ht,yt,It,Yt,be,Zt,wt,Vt,zt,$e,Gt,O,V,J,d,g,k,c,f,X,Je,Wt,Ue,Qt,qe,$t,Xe]}class Bl extends Al{constructor(t){super(),Sl(this,t,Rl,Fl,cl,{},null,[-1,-1,-1,-1])}}new Bl({target:document.getElementById("app")});
